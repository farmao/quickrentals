<!DOCTYPE html>
<html lang="en-In">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quick Rentals</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link rel="stylesheet" href="style.css" />

  <link rel="apple-touch-icon" sizes="180x180" href="images/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="images/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="images/favicon/favicon-16x16.png">
  <link rel="manifest" href="images/favicon/site.webmanifest">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">


  <style>
      .game-details {
          max-width: 800px;
          margin: 0 auto;
          padding: 20px;
          background: white;
          border-radius: 12px;
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .game-header {
          display: flex;
          gap: 30px;
          margin-bottom: 30px;
      }

      .game-image {
          width: 300px;
          border-radius: 8px;
      }

      .game-info h1 {
          margin-top: 0;
          color: #2c3e50;
      }

      .video-container {
          position: relative;
          padding-bottom: 56.25%;
          height: 0;
          margin: 30px 0;
      }

      .video-container iframe {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          border-radius: 8px;
      }

      .back-link {
          display: inline-block;
          margin-bottom: 20px;
          color: #4a90e2;
          text-decoration: none;
      }

      .back-link:hover {
          text-decoration: underline;
      }

      .rent-button {
          background: #25d366;
          color: white;
          padding: 8px 12px;
          border-radius: 6px;
          text-decoration: none;
          font-weight: 500;
          font-size: 0.9em;
          transition: background 0.2s;
          display: inline-block;
      }

      .rent-button:hover {
          background: #128C7E;
      }

      .description {
          background: #f8f9fa;
          padding: 20px;
          border-radius: 8px;
          margin: 20px 0;
      }

      h2,
      h3 {
          color: #2c3e50;
      }

      .additional-option {
          background: #4a90e2;
          color: white;
          padding: 8px 12px;
          border-radius: 6px;
          text-decoration: none;
          font-weight: 500;
          font-size: 0.9em;
          transition: background 0.2s;
          display: inline-block;
          }

      .additional-option:hover {
          background: #357abd;
          }
  </style>


  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-8MST0XFTF0"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-8MST0XFTF0');
  </script>

  <!-- Event snippet for Begin checkout conversion page
    In your html page, add the snippet and call gtag_report_conversion when someone clicks on the chosen link or button. -->
  <script>
      function gtag_report_conversion(url) {
          var callback = function () {
              if (typeof(url) != 'undefined') {
              window.location = url;
              }
          };
          gtag('event', 'conversion', {
              'send_to': 'AW-17088660868/_UU9COOnmcsaEISLwdQ_',
              'value': 1.0,
              'currency': 'INR',
              'event_callback': callback
          });
          return false;
          }
  </script>

  <!-- Meta Pixel Code -->
  <script>
    !function (f, b, e, v, n, t, s) {
      if (f.fbq) return; n = f.fbq = function () {
        n.callMethod ?
          n.callMethod.apply(n, arguments) : n.queue.push(arguments)
      };
      if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
      n.queue = []; t = b.createElement(e); t.async = !0;
      t.src = v; s = b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t, s)
    }(window, document, 'script',
      'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1189804459188113');
    fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=1189804459188113&ev=PageView&noscript=1" /></noscript>
  <!-- End Meta Pixel Code -->

  <!-- Facebook Domain Verification -->
  <meta name="facebook-domain-verification" content="xjara8o5lgkjuar3xokob58t11llwd" />

  <!-- Meta Pixel Code 2 - we are using this one for ads -->
  <script>
    !function (f, b, e, v, n, t, s) {
      if (f.fbq) return; n = f.fbq = function () {
        n.callMethod ?
        n.callMethod.apply(n, arguments) : n.queue.push(arguments)
      };
      if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
      n.queue = []; t = b.createElement(e); t.async = !0;
      t.src = v; s = b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t, s)
    }(window, document, 'script',
      'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '3914026305515369');
    fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=3914026305515369&ev=PageView&noscript=1" /></noscript>
  <!-- End Meta Pixel Code -->
</head>

<body>

  <div class="game-details">
    <a href="../index.html" class="back-link">‚Üê Back to Home</a>

    <header>
      <h1>Your Cart</h1>
    </header>

  <section class="category">

    <div id="cart-container"></div>

    <div id="date-section" style="display: none;">
      <label for="startInput"><strong>Start Date:</strong></label>
      <input id="startInput" placeholder="DD/MM/YYYY">
      <label for="endInput"><strong>End Date:</strong></label>
      <input id="endInput" placeholder="DD/MM/YYYY">
      <p id="output"></p>
    </div>


    <div id="pincode-section" style="display: none;">
      <label for="pincodeInput"><strong>Enter Pincode:</strong></label>
      <input id="pincodeInput" type="text" placeholder="e.g. 560001">
      <p id="pincodeMessage" style="margin-top: 5px;"></p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <script>
      flatpickr("#startInput", {dateFormat: "d/m/Y"});
      flatpickr("#endInput", {dateFormat: "d/m/Y"});
    </script>

    <button onclick="sendToWhatsApp()" target="_blank" class="rent-button" 
                    style="margin-bottom: 10px; display: inline-block;">Checkout via WhatsApp</button>
    
    <script>
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      let total = 0;
      let totaldeposit = 0;

      const itemQtyLimits = {
      chair: 4,
      'ps5-controller': 3,
      // Add more exceptions here (all others default to 1)
      };

      function updateCartDisplay() {
        const container = document.getElementById("cart-container");
        container.innerHTML = "";

        if (cart.length === 0) {
          container.innerHTML = "<p>Your cart is empty.</p>";
          return;
        }

        total = 0;
        totaldeposit = 0;

        let table = "<table><tr><th>Item</th><th>Qty</th><th>Price</th><th>Deposit</th></tr>";

        cart.forEach((item, index) => {
          const itemTotal = item.qty * item.price;
          total += itemTotal;
          const itemDeposit = item.qty * item.deposit;
          totaldeposit += itemDeposit;

          table += `
            <tr>
              <td>${item.name}</td>
              <td>
                <button onclick="changeQty(${index}, -1)">‚àí</button>
                ${item.qty}
                <button onclick="changeQty(${index}, 1)">+</button>
              </td>
              <td>‚Çπ${itemTotal}</td>
              <td>‚Çπ${itemDeposit}</td>
            </tr>
          `;
        });

        table += `</table><strong>Rental charge:</strong> ‚Çπ${total}/day<br><strong>Deposit:</strong> ‚Çπ${totaldeposit}</p>`;
        container.innerHTML = table;

        document.getElementById("date-section").style.display = cart.length > 0 ? "block" : "none";
        calculateRentalDays();        
      }

      function changeQty(index, delta) {
        const item = cart[index];
        const maxQty = itemQtyLimits[item.id] || 1; // Default to 1 if not specified

        if (delta > 0 && item.qty >= maxQty) {
          alert(`Sorry, you can only rent up to ${maxQty} ${item.name}(s) at this moment`);
          return;
        }

        item.qty += delta;

        if (item.qty <= 0) {
          cart.splice(index, 1); // Remove if quantity is 0
        }

        localStorage.setItem("cart", JSON.stringify(cart));
        updateCartDisplay();
      }

      const startInput = document.getElementById("startInput");
      const endInput = document.getElementById("endInput");
      const output = document.getElementById("output");

      function calculateRentalDays() {
        const [startDay, startMonth, startYear] = startInput.value.split("/");
        const [endDay, endMonth, endYear] = endInput.value.split("/");

        if (startInput.value && endInput.value) {
          const startDate = new Date(startYear, startMonth - 1, startDay);
          const endDate = new Date(endYear, endMonth - 1, endDay);

          if (endDate < startDate) {
            output.textContent = "‚ö†Ô∏è End date must be after start date.";
            return;
          }

          const utcStart = Date.UTC(startDate.getFullYear(), startDate.getMonth(), startDate.getDate());
          const utcEnd = Date.UTC(endDate.getFullYear(), endDate.getMonth(), endDate.getDate());
          const dayDiff = Math.max(1, Math.ceil((utcEnd - utcStart) / (1000 * 60 * 60 * 24)));

          // Calculate total rental cost
          const totalRentalCost = total * dayDiff; // ‚úÖ use the global value
          //output.textContent = `Rental Duration: ${dayDiff} day${dayDiff > 1 ? 's' : ''}`;
          //output.innerHTML = `<strong>Rental Duration:</strong> ${dayDiff} day${dayDiff > 1 ? 's' : ''}`;
          output.innerHTML = `
            <strong>Rental Duration:</strong> ${dayDiff} day${dayDiff > 1 ? 's' : ''}<br>
            <strong>Total Rental charge:</strong> ‚Çπ${totalRentalCost}<br>
            <strong>Total Deposit:</strong> ‚Çπ${totaldeposit}<br>
          `;

          document.getElementById("pincode-section").style.display = "block";

        } else {
          output.textContent = "";
        }
      }

      startInput.addEventListener("change", calculateRentalDays);
      endInput.addEventListener("change", calculateRentalDays);

      function sendToWhatsApp() {
        //if (cart.length === 0) return alert("Cart is empty!");

        if (cart.length === 0) {
          document.getElementById('modal-message').textContent = `Cart is empty!`;
          document.getElementById('cart-modal').style.display = 'flex'; // üëà show the modal
          return;
        }

        let message = "Hi, I‚Äôd like to rent the following items:%0A%0A";
        // 1Ô∏è‚É£ Items list with daily rent & deposit
        cart.forEach(item => {
          message += `‚Ä¢ ${item.name} (x${item.qty})%0A - ‚Çπ${item.price * item.qty} %2B ‚Çπ${item.deposit * item.qty} (Deposit)%0A`;
        });


        const startDate = startInput.value.trim();
        const endDate = endInput.value.trim();

        let rentalDays = 1;
        if (startDate && endDate) {
          const [startDay, startMonth, startYear] = startDate.split("/");
          const [endDay, endMonth, endYear] = endDate.split("/");
          const start = new Date(startYear, startMonth - 1, startDay);
          const end = new Date(endYear, endMonth - 1, endDay);

          if (end >= start) {
            const utcStart = Date.UTC(start.getFullYear(), start.getMonth(), start.getDate());
            const utcEnd = Date.UTC(end.getFullYear(), end.getMonth(), end.getDate());
            rentalDays = Math.max(1, Math.ceil((utcEnd - utcStart) / (1000 * 60 * 60 * 24)));
          }
        }

        const totalRentalCost = total * rentalDays;       

        // 2Ô∏è‚É£ Rental dates and duration
        message += `%0AI'd like to rent these for ${rentalDays} day${rentalDays > 1 ? 's,' : ','}`;
        message += ` from ${endDate}`;
        message += ` to ${endDate}`;

        const pincode = pincodeInput.value.trim();
        const info = deliveryZones[pincode];


        // 4Ô∏è‚É£ Delivery info
        message += `%0AI live in ${pincode}`;

        // 3Ô∏è‚É£ Rental totals
        message += `%0ATotal Rental charge: ‚Çπ${totalRentalCost}`;
        message += `%0ATotal Deposit: ‚Çπ${totaldeposit}`;

          const deliveryTimes = {
            0: '2 hour',
            1: '4 to 6 hour',
            2: '8 hour'
          };


        if (info && info.available === true) {
          message += `%0ADelivery Charge: ‚Çπ${info.charge}`;
          message += `%0ADelivery Time: ${deliveryTimes[info.fast] || 'Unspecified'}`;
        } else {
          message += `%0ADelivery not available in this pincode, but`;
        }

        message += `%0A%0APlease let me know the availability.`;

        const phone = "919892525821"; // Replace with your WhatsApp number
        const waUrl = `https://wa.me/${phone}?text=${message}`;

        window.open(waUrl, "_blank");
      }

      const pincodeInput = document.getElementById("pincodeInput");
      const pincodeMessage = document.getElementById("pincodeMessage");

      const freefastDeliveryZones = ["400062", "400063",  "400064", "400065", "400066", "400067",
                                      "400090", "400091", "400092", "400101", "400104"];
      
      const freeslowDeliveryZones = ["400001", "400002", "400003", "400004", "400005", "400006", "400007", "400008", "400009", "400010", 
                                    "400011", "400012", "400013", "400014", "400015", "400016", "400017", "400018", "400019", 
                                    "400020", "400021", "400022", "400024", "400025", "400026", "400027", "400028", "400029", 
                                    "400030", "400031", "400032", "400033", "400034", "400035", "400037", "400042", "400043", 
                                    "400049", "400050", "400051", "400052", "400053", "400054", "400055", "400056", "400057", 
                                    "400058", "400059", "400060", "400061", 
                                    "400068", "400069", "400070", "400071", "400072", "400074", "400075", "400076", "400077", 
                                    "400078", "400079", "400080", "400081", "400082", "400083", "400084", "400085", "400086", 
                                    "400087", "400088", "400089", "400093", "400094", "400095", "400096", 
                                    "400098", "400099", "400102", "400103"];
      const paidDeliveryZones100 = ["400068","401107","401104","401101","401105","401207","401201","401202","401208","401203", //Mira road to Virar
                                  "401209","401303","401305"];

      const paidDeliveryZones200 = ["400703","400705","400709","400701","400708","400706","400614","410210","410209","410218", //Navi Mumbai
                                  "410208","410206","410221",
                                  "400601","400602","400603","400604","400605","400606","400607","400608","400612","400615" //Thane
                                  ];

      const deliveryZones = {};

      freefastDeliveryZones.forEach(pincode => {
        deliveryZones[pincode] = { available: true, charge: 0, fast: 0 };
      });

      freeslowDeliveryZones.forEach(pincode => {
        deliveryZones[pincode] = { available: true, charge: 0, fast: 1 };
      });
      
      paidDeliveryZones100.forEach(pincode => {
        deliveryZones[pincode] = { available: true, charge: 100, fast: 2  };
      });

      paidDeliveryZones200.forEach(pincode => {
        deliveryZones[pincode] = { available: true, charge: 200, fast: 2  };
      });

      pincodeInput.addEventListener("input", () => {
      const pincode = pincodeInput.value.trim();
      const info = deliveryZones[pincode];

      if (!pincode) {
        pincodeMessage.textContent = "";
      } else if (pincode.length < 6)  {
        pincodeMessage.textContent = "Enter a valid pin code ";
        return
      }  else if (pincode.length = 6)  {
        pincodeMessage.textContent = "";
        
      }  else if (pincode.length > 6)  {
        pincodeMessage.textContent = "Enter a valid pin code "
        return;
      };

      if (pincode.length > 6)  {
        pincodeMessage.textContent = "Enter a valid pin code "
        return;
      };



      if (!info || info.available !== true) {
        pincodeMessage.innerHTML = `<strong>We currently do not deliver to this pincode.</strong>`;
      } else if (info.charge === 0 && info.fast === 0 ) {
        pincodeMessage.innerHTML = `<strong> Free 1 hour delivery!</strong>`;
      } else if (info.charge === 0 && info.fast === 1 ) {
        pincodeMessage.innerHTML = `<strong> Free 4 hour delivery!</strong>`;
      } else {
        pincodeMessage.innerHTML = `<strong> We can deliver within 8 hours. Delivery + Pickup charges: </strong> ‚Çπ${info.charge}`;
      }
      });


      function closeModal() {
        document.getElementById('cart-modal').style.display = 'none';
      }  //Defined here because I wasn't able to call the cart.js correctly

      updateCartDisplay();
    </script>
  </section> 
  
  <div id="cart-modal" class="modal">
    <div class="modal-content">
      <p id="modal-message"></p>
      <div class="modal-buttons">
        <button class="btn-continue" onclick="closeModal()">Continue Shopping</button>
      </div>
    </div>
  </div>

</body>



<footer>
  <div id="footer-placeholder"></div>

<script>
  fetch('/footer.html')
    .then(res => res.text())
    .then(html => {
      document.getElementById('footer-placeholder').innerHTML = html;
    });
</script>
</footer>

</html>